# Exam #1: "Car Rental"
## Student: s269705 Bruno Andrea 

## React client application routes

- Route `/`:  
Main route, contains the list of vehicles that can be filtered by category or brand (both for unauthenticated and authenticated users)
- Route `/login`:  
Login page, inserting a valid username and password, a user can authenticate (both for unauthenticated and authenticated users)
- Route `/rentals`:  
Page that lists past and future rentals of the user, and allows the removal of future ones (only for authenticated users)
- Route `/newrental`:  
Page in which a user can book a new rental, inserting all the required fields, and giving credit card information (only for authenticated users)

## REST API server

- GET `/api/vehicles`  
Lists all the vehicles in the system (no need for cookie)   
  - No input
  - Gives a list of vehicle objects: {id, category, brand, model}

- POST `/api/login`  
Allows a user to log in (no need for cookie)  
  - Receives authentication info {username, password}
  - Sets the cookie

- GET `/api/user`  
Verifies if the user is authenticated  
  - Checks cookie
  - No response (status 401 means unauthorized)

- POST `/api/logout`  
Allows a user to log out
  - Checks cookie
  - No response (clears cookie)

- GET `/api/rentals`  
Gives the list of rentals of the authenticated user
  - Checks cookie
  - Gives a list of rentals {id, userId, vehicleId, startDay,
        endDay,  carCategory,  age,  driversNumber,
        estimatedKm, insurance,  price}

- DELETE `/api/rentals/:id`  
Deletes a rental with specified id
  - Receives the id of the rental
  - No response (only status)

- GET `/api/rentals/past`  
Returns the number of past rentals of the authenticated user
  - Checks cookie
  - Gives the number of past rentals {num}

- POST `/api/stubpayment`  
API that simulates the interaction with an extern bank: checks the presence of the fields
  - Receives credit card information {fullName , cardNumber , cvv}
  - No response (only status)

- GET `/api/vehicles/occupied`  
Given a car category, a start and an end date, checks the percentage of occupied cars and the number of free ones
  - Receives filters as query parameters (?category= &startDay= &endDay=)
  - Gives the percentage of occupied vehicles and the number of free ones {prec, free}

- POST `/api/rentals`  
Given rental information, accepts a new rental for an authenticated user
  - Receives a new rental {category ,startDay ,endDay ,estimatedkm ,age ,drivers ,insurance ,price}
  - No response (only status)

## Server database

- Table `users`
  - id: Primary key autogenerated by the db
  - username: Unique name of the user
  - hash: Hash of the password of the user

- Table `vehicles`
  - id: Primary key autogenerated by the db
  - category: Category of the vehicle (A, B, C, D, E)
  - brand: Brand of the vehicle
  - model: Model of the vehicle

- Table `rentals`
  - id: Primary key autogenerated by the db
  - userId: Identifier of the user that booked the rental (primary key of `users`)
  - userId: Identifier of the vehicle assigned to the rental (primary key of `vehicles`)
  - startDay: First day of the rental
  - endDay: Last day of the rental
  - carCategory: Category of the vehicle (A, B, C, D, E)
  - age: Age of the principal driver of the rented car
  - driversNumber: Number of additional drivers for the rented car
  - estimatedKm: Estimated number of kilometers per day of rental
  - insurance: 1 for extra insurance, 0 for no extra insurance
  - price: Integer number that expresses the number of cents paid for the rental (to avoid storing and dealing with floating numbers for money)


## Main React Components

- `App` (in `App.js`): Main container of the pages, handles general error messages and differentiates the login page rfom the other ones
  - `Login` (in `Login.js`): Page for the login
  - `Main` (in `Main.js`): Component that holds the authentication status of the user, and handles the routes of the principal pages. It also contains the navbar
    - `Vehicles` (in `Vehicles.js`): Shows the list of vehicles, and lets the user filter them by category and brand
      - `VehiclesList` (in `Vehicles.js`): List of vehicles
        - `VehicleElement` (in `Vehicles.js`): Single vehicle
      - `CategoriesList` (in `Vehicles.js`): List of buttons for category filters
        - `CategoryElement` (in `Vehicles.js`): Single button for category filters
      - `BrandsList` (in `Vehicles.js`): List of buttons for brand filters
        - `BrandElement` (in `Vehicles.js`): Single button for brand filters
    - `Rentals` (in `Rentals.js`): Shows the list of past and future rentals of the authenticated user, and lets him delete future ones
      - `RentalsList` (in `Rentals.js`): List of rentals (internally divides past and future ones)
        - `RentalElement` (in `Rentals.js`): Single rental
          - `TemporaryElement` (in `Rentals.js`): When a rental is deleted by the user, this stub element is rendered until the data is re-fetched from the server
    - `NewRental` (in `NewRental.js`): Page with the form that handles the creation of a new rental

## Screenshot
<!---
![Configurator Screenshot](./img/screenshot.jpg)
-->

## Test users

| Username | Password | Is frequent? |
| -------- | -------- | ------------ |
| user1    | user1    | Frequent     |
| user2    | user2    |              |
| user3    | user3    |              |
| user4    | user4    |              |
| user5    | user5    |              |
